source="soc_task2_sample_logs.txt" host="kali" sourcetype="Soc logs"
| eval login_success=if(action="login success",1,0),
       login_failed=if(action="login failed",1,0),
       connection_attempt=if(action="connection attempt",1,0),
       file_accessed=if(action="file accessed",1,0),
       malware_detected=if(action="malware detected",1,0)
| stats sum(login_success) AS "Login Success",
        sum(login_failed) AS "Login Failed",
        sum(connection_attempt) AS "Connection Attempts",
        sum(file_accessed) AS "Files Accessed",
        sum(malware_detected) AS "Malware Detected"
  BY user
| sort - "Malware Detected" "Login Failed"
